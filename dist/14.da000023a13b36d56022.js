webpackJsonp([14],{1017:function(e,t,i){t=e.exports=i(6)(),t.push([e.i,".exchangeGoods[data-v-0352037c]{padding:0 20px}.exchangeGoods .title[data-v-0352037c]{color:#8492a6;font-weight:400;margin:10px 0}.exchangeGoods .add_btn[data-v-0352037c],.exchangeGoods .good_list[data-v-0352037c]{margin:20px}.btns[data-v-0352037c]{margin-top:40px;margin-left:50px}.good[data-v-0352037c]{text-align:left;padding:10px}.good .good-img[data-v-0352037c]{display:inline-block;width:30%;vertical-align:top}.good .good-name-price[data-v-0352037c]{display:inline-block;width:60%;margin-left:10px;vertical-align:top}.good .good-name-price .good-name[data-v-0352037c],.good .good-name-price .good-price[data-v-0352037c]{margin:5px 0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}",""])},1018:function(e,t,i){t=e.exports=i(6)(),t.push([e.i,".pg_content[data-v-0601ab2d]{padding:0}.pg_content .save_btn[data-v-0601ab2d]{margin:20px}.good[data-v-0601ab2d]{text-align:left;padding:10px}.good .good-img[data-v-0601ab2d]{display:inline-block;width:20%;vertical-align:top}.good .good-bg-img[data-v-0601ab2d]{display:inline-block;width:80px;vertical-align:top;height:80px;background-color:#e5e9f2}.good .good-name-price[data-v-0601ab2d]{display:inline-block;width:70%;margin-left:10px;vertical-align:top}.good .good-name-price .good-name[data-v-0601ab2d],.good .good-name-price .good-price[data-v-0601ab2d]{margin:5px 0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}",""])},1030:function(e,t,i){t=e.exports=i(6)(),t.push([e.i,".pg_content[data-v-223b27ee]{padding:0 20px}",""])},1121:function(e,t,i){"use strict";function o(e){i(1354)}var n=i(744),a=i(1208),s=i(2),r=o,c=s(n.a,a.a,r,"data-v-0601ab2d",null);t.a=c.exports},1122:function(e,t,i){"use strict";function o(e){i(1353)}var n=i(745),a=i(1206),s=i(2),r=o,c=s(n.a,a.a,r,"data-v-0352037c",null);t.a=c.exports},1123:function(e,t,i){"use strict";var o=i(746),n=i(1343),a=i(2),s=a(o.a,n.a,null,null,null);t.a=s.exports},1206:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("pg-box",{attrs:{isShowBox:e.show},on:{close:e.close}},[i("div",{staticClass:"box_title"},[e._v(e._s(e.title))]),e._v(" "),i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"130px",rules:e.rules}},[i("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[i("el-input",{staticStyle:{width:"50%"},model:{value:e.form.name,callback:function(t){e.form.name=t},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"活动banner"}},[i("pg-img-upload",{attrs:{tip:"只能上传.png、.jpg格式的图片",image:e.form.imgUrl},on:{success:e.uploadSuccess}})],1),e._v(" "),i("el-form-item",{attrs:{label:"活动兑换条件描述"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"textarea",rows:5},model:{value:e.form.description,callback:function(t){e.form.description=t},expression:"form.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"适用会员"}},[i("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全部会员")]),e._v(" "),i("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.memberGradeList,callback:function(t){e.memberGradeList=t},expression:"memberGradeList"}},e._l(e.memberList,function(t){return i("el-checkbox",{key:t.memberGradeID,attrs:{label:t.memberGradeID}},[e._v(e._s(t.name))])}))],1),e._v(" "),i("el-form-item",{attrs:{label:"有效期"}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间"},model:{value:e.form.beginTime,callback:function(t){e.form.beginTime=t},expression:"form.beginTime"}}),e._v("\n              至  \n            "),i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择结束时间"},model:{value:e.form.endTime,callback:function(t){e.form.endTime=t},expression:"form.endTime"}})],1)],1),e._v(" "),i("div",{staticClass:"exchangeGoods"},[i("h3",{staticClass:"title"},[e._v("兑换商品")]),e._v(" "),i("el-button",{staticClass:"add_btn",attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("添加商品")]),e._v(" "),i("el-table",{staticClass:"good_list",staticStyle:{width:"100%"},attrs:{data:e.goodsList,"highlight-current-row":"",border:"",stripe:""}},[i("el-table-column",{attrs:{align:"center",prop:"",label:"商品","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"good"},[i("pg-img",{staticClass:"good-img",attrs:{src:t.row.img?t.row.img:""}}),e._v(" "),i("div",{staticClass:"good-name-price"},[i("div",{staticClass:"good-name"},[e._v(e._s(t.row.goodsName))]),e._v(" "),i("p",{staticClass:"good-price"},[e._v("￥"+e._s(t.row.goodPrice))])])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"url",label:"库存","min-width":"100"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"",label:"兑换总量","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-input",{model:{value:e.row.maxQty,callback:function(t){e.row.maxQty=t},expression:"scope.row.maxQty"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"",label:"兑换所需积分","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-input",{model:{value:e.row.integral,callback:function(t){e.row.integral=t},expression:"scope.row.integral"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"",label:"兑换价","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-input",{model:{value:e.row.price,callback:function(t){e.row.price=t},expression:"scope.row.price"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"",label:"每人限购数","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-input",{model:{value:e.row.maxBuy,callback:function(t){e.row.maxBuy=t},expression:"scope.row.maxBuy"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("pg-button",{attrs:{icon:"xiugai"},on:{click:function(i){e.del(t.row,e.$index)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),i("div",{staticClass:"btns"},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),i("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("返回")])],1)],1)},n=[],a={render:o,staticRenderFns:n};t.a=a},1208:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("pg-dialog",{attrs:{isShow:e.showDialog},on:{close:e.close}},[i("div",{staticClass:"pg_content"},[i("h3",[e._v("选择商品")]),e._v(" "),i("pg-search-form",{attrs:{"default-form":e.defaultQuery,more:e.moreQuery,"is-show-more":e.isShowMoreQuery},on:{openMore:e.toggleOpen,search:e.search},slot:"search-form",model:{value:e.query.condition,callback:function(t){e.query.condition=t},expression:"query.condition"}}),e._v(" "),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.goodList,"highlight-current-row":"",border:"",stripe:""},on:{"selection-change":e.selectChange}},[i("el-table-column",{attrs:{align:"center",fixed:"left",type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"",label:"商品","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"good"},[i("pg-img",{staticClass:"good-img",attrs:{src:t.row.img?t.row.img:""}}),e._v(" "),i("div",{staticClass:"good-name-price"},[i("div",{staticClass:"good-name"},[e._v(e._s(t.row.goodsName))]),e._v(" "),i("p",{staticClass:"good-price"},[e._v("￥"+e._s(t.row.goodPrice))])])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"qty",label:"库存","min-width":"200"}})],1),e._v(" "),i("pg-pagination",{attrs:{"page-size":e.query.pageSize,total:e.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange},slot:"pagination"}),e._v(" "),i("el-button",{staticClass:"save_btn",on:{click:e.save}},[e._v("确定")])],1)])},n=[],a={render:o,staticRenderFns:n};t.a=a},1230:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"customView"},[i("pg-search-form",{staticClass:"search",attrs:{"default-form":e.defaultQuery,more:e.moreQuery,resetForm:e.resetForm,"is-show-more":e.isShowMoreQuery},on:{openMore:e.toggleOpen,search:e.search},slot:"search-form",model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),e._v(" "),i("div",{staticClass:"pg_content"},[i("pg-operations",{attrs:{btns:e.operations},on:{add:e.add}}),e._v(" "),i("pg-table",{attrs:{list:e.customPageList},on:{"select-change":e.selectChange,edit:e.edit,del:e.del,ending:e.ending,copy:e.copy}}),e._v(" "),i("pg-pagination",{attrs:{"page-size":e.query.pageSize,total:e.total},on:{"size-change":e.sizeChange,"current-change":e.currentChange},slot:"pagination"})],1),e._v(" "),i("pg-edit",{attrs:{title:e.editTitle,show:e.showEdit,isEdit:e.isEdit,editForm:e.editForm},on:{close:e.closeEdit,refresh:e.refresh,addGoods:e.addGoods}}),e._v(" "),i("pg-goodlist",{attrs:{showDialog:e.showDialog},on:{closeDialog:e.closeDialog}})],1)},n=[],a={render:o,staticRenderFns:n};t.a=a},1343:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,"highlight-current-row":"",border:"",stripe:""},on:{"selection-change":e.selectChange}},[i("el-table-column",{attrs:{align:"center",prop:"name",label:"活动名称","min-width":"200"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"goodsQty",label:"可兑商品数","min-width":"150"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"maxQt",label:"兑换总量","min-width":"100"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"surplusQty",label:"剩余兑换量","min-width":"150"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"flagDesc",label:"状态","min-width":"100"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"createTime",label:"建立时间","min-width":"200"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("pg-button-group",[i("pg-button",{attrs:{icon:"chakan"},on:{click:function(i){e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),i("pg-button",{attrs:{icon:"chakan"},on:{click:function(i){e.ending(t.row)}}},[e._v("结束")]),e._v(" "),i("pg-button",{attrs:{icon:"chakan"},on:{click:function(i){e.copy(t.row)}}},[e._v("复制")]),e._v(" "),i("pg-button",{attrs:{icon:"xiugai"},on:{click:function(i){e.del(t.row)}}},[e._v("删除")])],1)]}}])})],1)},n=[],a={render:o,staticRenderFns:n};t.a=a},1353:function(e,t,i){var o=i(1017);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i(16)("25efc6d9",o,!0)},1354:function(e,t,i){var o=i(1018);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i(16)("3fe7f544",o,!0)},1366:function(e,t,i){var o=i(1030);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i(16)("18137dc4",o,!0)},248:function(e,t,i){"use strict";function o(e){i(1366)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(747),a=i(1230),s=i(2),r=o,c=s(n.a,a.a,r,"data-v-223b27ee",null);t.default=c.exports},744:function(e,t,i){"use strict";var o=i(1),n=i.n(o),a=i(893);t.a=n()({},a.a)},745:function(e,t,i){"use strict";var o=i(1),n=i.n(o),a=i(894);t.a=n()({},a.a)},746:function(e,t,i){"use strict";var o=i(1),n=i.n(o),a=i(895);t.a=n()({},a.a)},747:function(e,t,i){"use strict";var o=i(1),n=i.n(o),a=i(896);t.a=n()({},a.a)},893:function(e,t,i){"use strict";var o=i(1),n=i.n(o),a=i(46),s=(i.n(a),i(30)),r=i(9);t.a={props:{showDialog:Boolean},data:function(){return{isShowMoreQuery:!1,query:{condition:{name:"",code:"",deptID:""},page:1,pageSize:15},total:0,selected:[],goodList:[],goodClass:[]}},computed:n()({},i.i(r.mapGetters)(["goodsList"]),{defaultQuery:{get:function(){return[{type:"input",label:"商品名",model:"name"},{type:"input",label:"商品货号",model:"code"}]}},moreQuery:{get:function(){return[{type:"select",label:"分类",text:"name",value:"deptID",model:"deptID",options:this.goodClass}]}}}),watch:{showDialog:function(){var e=this;this.showDialog&&this.$nextTick(function(){e.toggleRowSelection()})}},mounted:function(){this.getExchangeGoodsPageList(),this.getGoodsTree()},methods:n()({},i.i(r.mapActions)(["selectGoods"]),{getExchangeGoodsPageList:function(){var e=this;s.f.getExchangeGoodsPageList(this.query).then(function(t){e.goodList=t.data,e.total=t.totalCount})},getGoodsTree:function(){var e=this;s.e.getGoodsTree().then(function(t){e.goodClass=[],t.forEach(function(t){e.goodClass.push({name:t.name,deptID:t.deptID})})})},close:function(){this.$emit("closeDialog"),this.$refs.multipleTable.clearSelection()},toggleOpen:function(e){this.isShowMoreQuery=e},search:function(){this.query.page=1,this.getExchangeGoodsPageList()},selectChange:function(e){this.selected=e},toggleRowSelection:function(){for(var e=0;e<this.goodsList.length;e++)for(var t=0;t<this.goodList.length;t++)this.goodsList[e].goodsID===this.goodList[t].goodsID&&this.$refs.multipleTable.toggleRowSelection(this.goodList[t],!0)},currentChange:function(e){this.query.page=e,this.getExchangeGoodsPageList()},sizeChange:function(e){this.query.pageSize=e,this.getExchangeGoodsPageList()},save:function(){this.selectGoods(this.selected),this.close()}})}},894:function(e,t,i){"use strict";var o=i(1),n=i.n(o),a=i(46),s=(i.n(a),i(30)),r=i(9);t.a={props:{title:String,show:Boolean,isEdit:Boolean,editForm:Object},data:function(){return{form:{},initForm:{integralExchangeID:"",name:"",imgUrl:"",note:"",description:"",memberGradeList:[],beginTime:"",endTime:"",activeGoodsList:[]},rules:{name:[{required:!0,message:"请输入活动名",trigger:"blur"}]},isIndeterminate:!0,checkAll:!1,memberList:[],memberGradeList:[]}},watch:{editForm:function(e){this.setForm(this.editForm)}},computed:n()({},i.i(r.mapGetters)(["goodsList"])),mounted:function(){this.getMemberGrade()},methods:n()({},i.i(r.mapActions)(["selectGoods"]),{resetForm:function(){this.form=i.i(a.cloneDeep)(this.initForm)},setForm:function(e){var t=this;this.isEdit?(this.form=i.i(a.cloneDeep)(this.editForm),this.form.description=this.form.description.replace(/<br>/g,"\n"),this.checkAll=!1,this.isIndeterminate=!0,this.form.memberGradeList.length===this.memberList.length&&(this.checkAll=!0,this.isIndeterminate=!1),this.memberGradeList=[],this.form.memberGradeList.forEach(function(e){t.memberGradeList.push(e.memberGradeID)}),this.selectGoods(this.form.activeGoodsList)):this.resetForm()},getMemberGrade:function(){var e=this;s.f.getMemberGrade().then(function(t){e.memberList=t})},del:function(e,t){this.goodsList.pop(t-1)},close:function(){this.$emit("close"),this.selectGoods([])},save:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.form.description=e.form.description.replace(/\n/g,"<br>"),e.form.activeGoodsList=e.goodsList,s.f.saveActive(e.form).then(function(){e.$message({message:"保存成功",type:"success"}),e.refresh(),e.close()}).catch(function(t){e.$message.error(t)}))})},uploadSuccess:function(e){this.form.imgUrl=e},addGoods:function(){this.$emit("addGoods")},handleCheckAllChange:function(e){var t=this;this.form.memberGradeList=e.target.checked?this.memberList:[],this.isIndeterminate=!1,this.memberGradeList=[],e.target.checked&&this.memberList.forEach(function(e){t.memberGradeList.push(e.memberGradeID)})},handleCheckedCitiesChange:function(e){var t=this,i=e.length;this.checkAll=i===this.memberList.length,this.isIndeterminate=i>0&&i<this.memberList.length,this.form.memberGradeList=[],this.memberGradeList.forEach(function(e){t.memberList.forEach(function(i){e===i.memberGradeID&&t.form.memberGradeList.push(i)})})},refresh:function(){this.$emit("refresh")}})}},895:function(e,t,i){"use strict";i(30);t.a={props:{list:Array},methods:{edit:function(e){this.$emit("edit",e)},del:function(e){this.$emit("del",e)},ending:function(e){this.$emit("ending",e)},copy:function(e){this.$emit("copy",e)},selectChange:function(e){this.$emit("select-change",e)}}}},896:function(e,t,i){"use strict";var o=i(1123),n=i(1122),a=i(1121),s=i(30);t.a={components:{PgTable:o.a,PgEdit:n.a,PgGoodlist:a.a},data:function(){return{query:{condition:{name:"",flag:-1},page:1,pageSize:15},resetForm:{condition:{name:"",flag:-1},page:1,pageSize:15},total:0,selected:[],editTitle:"编辑",editForm:{},isEdit:!1,showEdit:!1,isShowMoreQuery:!1,operations:[{name:"新增",action:"add",type:"primary"}],customPageList:[],showDialog:!1,integralExchangeID:""}},computed:{defaultQuery:{get:function(){return[{type:"input",label:"活动名称",model:"condition.name"},{type:"select",label:"活动状态",text:"title",value:"value",model:"condition.flag",options:[{title:"全部",value:-1},{title:"进行中",value:0},{title:"未开始",value:1},{title:"已结束",value:2}]}]}},moreQuery:{get:function(){return[]}}},mounted:function(){this.getActivePageList()},methods:{getActivePageList:function(){var e=this;s.f.getActivePageList(this.query).then(function(t){e.customPageList=t.data,e.total=t.totalCount})},toggleOpen:function(e){this.isShowMoreQuery=e},search:function(){this.query.page=1,this.getActivePageList()},selectChange:function(e){this.selected=e},currentChange:function(e){this.query.page=e,this.getActivePageList()},sizeChange:function(e){this.query.pageSize=e,this.getActivePageList()},addGoods:function(){this.showDialog=!0},closeDialog:function(){this.showDialog=!1},edit:function(e){var t=this;this.showEdit=!0,this.isEdit=!0,this.editTitle="编辑",s.f.getActiveDetail(e.integralExchangeID).then(function(e){t.editForm=e})},add:function(){this.showEdit=!0,this.isEdit=!1,this.editTitle="新增",this.editForm={}},del:function(e){var t=this;this.$confirm("您确定删除该积分活动?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.f.deleteActive(e.integralExchangeID).then(function(){t.$message({message:"删除成功",type:"success"}),t.refresh()}).catch(function(e){t.$message.error(e)})})},ending:function(e){var t=this;this.$confirm("您确定结束改积分活动?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.f.finishActive(e.integralExchangeID).then(function(){t.$message({message:"操作成功",type:"success"}),t.refresh()}).catch(function(e){t.$message.error(e)})})},copy:function(e){var t=this;s.f.copyActive(e.integralExchangeID).then(function(){t.$message({message:"复制成功",type:"success"}),t.refresh()}).catch(function(e){t.$message.error(e)})},refresh:function(){this.query.page=1,this.getActivePageList()},closeEdit:function(){this.showEdit=!1}}}}});